<html>
<head>
<title>index</title>
<link href="suggest.css" type="text/css" >
<script src="http://code.jquery.com/jquery-1.11.0.min.js"></script>
<script>
$(function(){
    // bind key up event and try get suggestion
    $('#suggest').keyup(function(){
        var self = this;
        var key = self.value;
        if (key && key.length > 0){
            key = encodeURIComponent(key);
            // send out ajax request to server
            $.getJSON('/sug?query=' + key, function(data){
                if (data['sug'].length>0){
                    // show sugg if reqId sent out is the same as recv
                    var suggArr=[], suggTxt;
                    $(data['sug']).each(function(idx,v){
                        console.log(v);
                        suggArr.push('<p><span><a href="/sehtml?query='+encodeURI(v, 'utf8')+'" target="iframe_a">'+v+'</a></span></p>');
                        //suggArr.push('<p class="querylist"><span>'+v+'</span></p>');
                    })
                    suggArr.push('');
                    $('#suggestList').html(suggArr.join(''));
                    changePosition(self, '#suggestList');
                }
            });
        }
    });
    function changePosition(input, sugg){
        var pTop = $(input).position().top + $(input).outerHeight(true);
        var pLeft = $(input).position().left;
        var pRight = $(input).position().right;
        $(sugg).css({
            'position': 'absolute',
            'border': 'solid 1px',
            'width': $(input).outerWidth(true),
            'left': $(input).position().left-1,
            'top': $(input).position().top + $(input).outerHeight(true)
        }).toggle(true);
        $('p', sugg).css({
            'margin': 0,
            'padding': 0
        });
    }
})
</script>
</head>
<body>
<frame>
<div style='margin:50px 200px;'>
  <input id='suggest' style='padding: 10px' maxlength="100" autocomplete=false>
</div>
<div id='suggestList' style='position:absolute; display:none;'></div>
</frame>


<iframe id="iframe_a" name="iframe_a" style='margin:0px 50px;' width='1280' height='800'><iframe>
</body>
</html>